Benutzerverwaltung
------------------
Das Programmpaket benutzt eine aktuelle von Kolleg (o.ä) erstellte
Schülerdatei, um die Benutzerliste des Linux-Server zu aktualisieren.
Das kann zum Schuljahresbeginn oder zu Beginn eines Halbjahres oder
zu jedem beliebigen Zeitpunkt geschehen.

Es besteht aus den Programmen
	format		OK
	listcmp		OK
	listadd		OK
	listdel		OK
	listneu
	add
	shadow		OK

/*
Für die erstmalige und einmalige Erfassung der Lehrer dienen die
Programme 
	listcmp.1st	NICHT GETESTET
	listadd.1st	NICHT GETESTET
Die Lehrer sollten vor den Schülern eingetragen werden, um bei den 
Benutzernamen der Lehrer Indizes zu vermeiden. Lesen Sie die
Anleitung in liesmich.1st.
*/

??? Das Programm add, das den Zugang eines einzelnen Benutzers abwickelt, 
kann zwischendurch benutzt werden. 
Für Schüler (gruppe=schueler) hält dieses Programm verschlüsselt das 
Geburtsdatum fest, um bei einem späteren automatischen Abgleich auch
Namensgleichheit berücksichtigen zu können.  
??? usage: ./add -g gruppe -l nachname -f vorname [vorname] -d geburtsdatum

Das Programm listneu zeigt ein Beispiel für nachträgliche Korrekturen in den
Verzeichnissen und/oder Datein aller Benutzer.

Ablauf
------

1. Vorhandene Daten sichern
   ------------------------
Datei '/etc/passwd' sichern ('cp /etc/passwd passwd.old' o.ä.)
Datei '/etc/shadow' sichern ('cp /etc/shadow shadow.old' o.ä.)
Nur bei erstmaligem Eintrag der Schüler:
    '/etc/passwd' anzeigen lassen ('more /etc/passwd')
    Alle Schüler (nur die Schüler!) mit 'userdel <benutzername>' streichen
    	{Begründung: Alle Schüler müssen neu eingetragen werden, damit das 
	Geburtsdatum korrekt eingefügt wird.}
	Hinweis: Die Home-Verzeichnisse werden dabei nicht gelöscht.
    	Sie müssen unter Umständen - bei Vergabe von Indizes - verschoben
        werden; z.B. wenn 'emuelle' zu 'emuelle1' wurde.}
Ein Verzeichnis '<schule>.goe' einrichten (z.B. 'mkdir mpg.goe') 
       {Das lesen die Programme, um die richtige Email-Adresse einzutragen.} 

2. Daten beschaffen
   ----------------
'daten.sdf' mit Kolleg erstellen
'daten.sdf' in das aktuelle Verzeichnis (das die Programme enthält) kopieren
'daten.sdf' aufbereiten (./format); das Ergebnis ist die Datei 'daten'

3. Daten abgleichen
   ----------------
Das Programm 'listcmp' starten (./listcmp)
	{Dieses Programm erzeugt zwei Dateien:
	'datadd.nnn' mit den Neuzugängen
	'datdel.nnn' mit den Abgänge}

4. Benutzer aufnehmen
   ------------------
Datei 'datadd.nnn' (mit höchstem Index nnn) kontrollieren
Das Programm 'listadd' starten (./listadd)
	{Die Neuen aus datadd.nnn werden in '/etc/passwd 'eingetragen,
	auch in /etc/shadow.
	Zugleich werden Home-Verzeichnisse angelegt.}
/etc/passwd auf korrekten Eintrag überprüfen (more /etc/passwd)
Das Programm shadow starten (./shadow)
	{Dieses Programm korrigiert die Shadow-Datei '/etc/shadow'.}

5. Kennwörter ausdrucken
   ---------------------
Mit Datei 'datpwd.nnn'  Serienbriefe drucken

6. Benutzer streichen
   ------------------
Datei 'datdel.nnn' kontrollieren, falls Abgänge vorkommen.
Das Programm 'listdel' starten (./listdel)
	{Dieses Programm streicht alle Schüler aus 'datdel.nnn' und
	verschiebt deren Home-Verzeichnis nach '/home/trash'.
	Diese Home-Verzechnisse sollten spätestens vor dem nächsten
	Zugang von Schülern gelöscht werden (rm -r -f /home/trash/*).}
	{Es kann sinnvoll sein, die Abgänger erst später zu streichen.}
Die abgearbeitete Datei 'datdel.nnn' löschen (rm datdel.001) oder besser
in einem Verzeichnis sichern (md daten.980918) (mv datdel.* daten.980918)}   
	


?????>>>>


Betroffene Dateien
------------------
Quelldateien:
-------------
/etc/passwd	System-Datei mit Benutzerbeschreibungen
		gast:x:501:100:Gast:/home/gast:/bin/bash
daten.sdf	mit Kolleg erstellte Datei mit Schülerdaten
		Fröhlich;Friedrich-Wilhelm;06.06.06;8f1

Hilfsdateien:
-------------
datadd.001	neue Schüler (in daten.sdf und nicht in /etc/passwd)
		ffroehl0:Friedrich-Wilhelm Froehlich,56787822:8f1
		(56787822 enthält das verschlüsselte Geburtsdatum.)
datdel.001	abgegangene Schüler (in /etc/passwd und nicht in ...)
		ffroehl0:Friedrich-Wilhelm Froehlich,56787822
datpwd.001	neue Schüler mit vorläufigem Kennwort für Serienbriefe
		11;Ferdinand Froehlich;ffroehl2;senatay;

		(Die Dateien werden fortlaufend indiziert;
		den Dateien werden jeweils gleiche Indizes angehängt.
		datadd.nnn kann nach dem Eintragen gelöscht werden.
		datdel.nnn kann nach dem Austragen gelöscht werden.
		datpwd.nnn kann nach dem Briefdruck gelöscht werden.
		Es kann sinnvoll sein, die Abgänger erst nach Ablauf einer
		Frist zu streichen und datdel.nnn solange aufzuheben.

dattmp		nur temporär
datsdf		nur temporär
datpwd		nur temporär

brief		Serienbrief (Word-Format) für Mitteilung an Schüler

Zieldateien:
------------
/etc/passwd	System-Datei mit Benutzerbeschreibungen
		ffroehl0:x:1000:102:Friedrich-Wilhelm Froehlich,56787822:
		/home/ffroehl0:/bin/bash
/etc/shadow	System-Datei mit verschlüsselten Kennwörtern
		ffroehl0:8gw4exBDw2YeQ:9947:10000:99999:7:0::0


Programme
---------
listcmp		liest /etc/passwd und daten.sdf und erstellt für Zugänge
		datadd.001 (bwz. fortlaufender Index) und,
		wenn Abgänge anliegen, datdel.001.
listdel		liest datdel.001 (oder nach Wunsch mit anderem Index)
		und streicht die dort angegebenen Benutzer.
listadd		liest datadd.001 (maximaler Index) und trägt die
		die dort angegebenen Benutzer ein.
		Für jeden neuen Benutzer wird ein Home-Verzeichnis
		erstellt und eingerichtet.
		Speziell wird in ~/system/netscape.ini für den
		Netscape-Browser die Email-Adresse eingetragen.
		Auf diese ini-Datei muß unter Windows for Workgroups in
		system.ini verwiesen werden (z.B. mit p:/system/netscape.ini),
		wenn in WfW das Laufwerk p: mit dem Home-Verzeichnis 
		verbunden ist).
pwd		C-Programm, das ein vorläufiges Kennwort generiert.
		Das Programm (Source pwd.c) sollte in der Formel für die
		Genierung des vorläufigen Passworts etwas abgeändert werden.
shadow		Korrigiert die /etc/shadow im Anschluss an listadd bzw. add.
listneu		Beispiel für eine Korrektur in Verzeichnis oder Datei aller
		Benutzer.










